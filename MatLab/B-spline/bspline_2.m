%- Reset all
close all;
clear all;
clc;    

%- Puntos
p0 = [0;   0];
p1 = [1;  -2];
p2 = [2.5; 2];
p3 = [5;   1];
p4 = [4;  -2];

%------------------%
%  First b-spline  %
%------------------%

%- Knot vector.
%- t1 = [0, 0, 0, 1, 2, 3, 3, 3];
t1   = 0:0.001:3;       
t11 = t1(t1(:)>=0 & t1(:)<=1);
t12 = t1(t1(:)>=1 & t1(:)<=2);
t13 = t1(t1(:)>=2 & t1(:)<=3);

n02   =  (1-t11).^2;            %[0,1]
n12_1 =  t11.*(1-t11);          %[0,1]
n12_2 =  ((2-t11).*t11)./2;     %[0,1]
n12_3 =  ((2-t12).^2)./2;       %[1,2]
n22_1 =  (t11.^2)./2;           %[0,1] 
n22_2 =  ((2-t12).*t12)./2;     %[1,2]
n22_3 =  ((3-t12).*(t12-1))./2; %[1,2]
n22_4 =  ((3-t13).^2)./2;       %[2,3]
n32_1 =  ((t12-1).^2)./2;       %[1,2]
n32_2 =  ((3-t13).*(t13-1))./2; %[2,3]
n32_3 =  (t13-2).*(3-t13);      %[2,3]
n42   =  (t13-2).^2;            %[2,3]

figure('Name','Basis functions - 1','NumberTitle','off');
plot(t11,n02,'red',...
     t11,n12_1,'green',t11,n12_2,'green',t12,n12_3,'green',...
     t11,n22_1,'blue',t12,n22_2,'blue',t11,n22_3,'blue',t12,n22_4,'blue',...
     t11,n32_1,'black',t12,n32_2,'black',t13,n32_3,'black',...
     t13,n42,'yellow');

%- Curve

c1 = n02.*p0 + (n12_1 + n12_2).*p1 + n22_1.*p2;
c2 = n12_3.*p1 + (n22_2 + n22_3).*p2 + n32_1.*p3;
c3 = n22_4.*p2 + (n32_2 + n32_3).*p3 + n42.*p4;

figure('Name','Curve - 1','NumberTitle','off');
plot(c1(1,:),c1(2,:),'red',c2(1,:),c2(2,:),'blue',c3(1,:),c3(2,:),'green');
xlabel('x');
ylabel('y');

%-------------------%
%  Second b-spline  %
%-------------------%

%- Knot vector
%- t2 = [0, 0, 0, 1.9, 2, 3, 3, 3];
t2   = 0:0.001:3;       
t21 = t2(t2(:)>=0   & t2(:)<=1.9);
t22 = t2(t2(:)>=1.9 & t2(:)<=2);
t23 = t2(t2(:)>=2   & t2(:)<=3);


%- Basis functions
m02   =  (1.9-t21).^1.9;                %[0,1.9]
m12_1 =  (t21.*(1.9-t21))./1.9;         %[0,1.9]
m12_2 =  ((2-t21).*t21)./3.8;           %[0,1.9]
m12_3 =  ((2-t22).^2)./0.2;             %[1.9,2]
m22_1 =  (t21.^2)./3.8;                 %[0,1.9] 
m22_2 =  ((2-t22).*t22)./0.2;           %[1.9,2]
m22_3 =  ((3-t22).*(t22-1.9))./0.11;    %[1.9,2]
m22_4 =  ((3-t23).^2)./1.1;             %[2,3]
m32_1 =  ((t22-1.9).^2)./0.11;          %[1,1.9]
m32_2 =  ((3-t23).*(t23-1.9))./1.1;     %[2,3]
m32_3 =  (t23-2).*(3-t23);              %[2,3]
m42   =  (t23-2).^2;                    %[2,3]

figure('Name','Basis functions - 2','NumberTitle','off');
plot(t21,m02,'red',...
     t21,m12_1,'green',t21,m12_2,'green',t22,m12_3,'green',...
     t21,m22_1,'blue',t22,m22_2,'blue',t22,m22_3,'blue',t23,m22_4,'blue',...
     t22,m32_1,'black',t23,m32_2,'black',t23,m32_3,'black',...
     t23,m42,'yellow');
 
 
%- Curve
c4 = m02.*p0 + (m12_1 + m12_2).*p1 + m22_1.*p2;
c5 = m12_3.*p1 + (m22_2 + m22_3).*p2 + m32_1.*p3;
c6 = m22_4.*p2 + (m32_2 + m32_3).*p3 + m42.*p4;

figure('Name','Curve - 2','NumberTitle','off');
plot(c4(1,:),c4(2,:),'red',c5(1,:),c5(2,:),'blue',c6(1,:),c6(2,:),'green');
xlabel('x');
ylabel('y');

%------------------%
%  Third b-spline  %
%------------------%

%- Knot vector
%- t2 = [0, 0, 0, 2, 2, 3, 3, 3];
t3   = 0:0.001:3;       
t31 = t3(t3(:)>=0 & t3(:)<=2);
t32 = t3(t3(:)>=2 & t3(:)<=3);

%- Basis functions

b02   = ((2-t31)./2).^2;     %[0,2]
b12   = ((2-t31).*t31)./2;   %[0,2]
b22_1 = (t31./2).^2;         %[0,2]
b22_2 = (3-t32).^2;          %[2,3]
b32   = 2.*(3-t32).*(t32-2); %[2,3]
b42   = (t32-2).^2;          %[2,3]

figure('Name','Basis functions - 3','NumberTitle','off');
plot(t31,b02,'red',...
     t31,b12,'green',...
     t31,b22_1,'blue',t32,b22_2,'blue',...
     t32,b32,'black',...
     t32,b42,'yellow');
 
 %- Curve

c7 = b02.*p0 + b12.*p1 + b22_1.*p2; 
c8 = b22_2.*p2 + b32.*p3 + b42.*p4;

figure('Name','Curve - 3','NumberTitle','off');
plot(c7(1,:),c7(2,:),'red',c8(1,:),c8(2,:),'blue');
xlabel('x');
ylabel('y');
 
 